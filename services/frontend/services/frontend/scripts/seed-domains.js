const { Pool } = require("pg"); const fs = require("fs"); const path = require("path"); const pool = new Pool({ connectionString: process.env.DATABASE_URL, ssl: process.env.NODE_ENV === "production" ? { rejectUnauthorized: false } : false }); const domainsText = fs.readFileSync(path.join(__dirname, "..", "domains.txt"), "utf8"); const domains = domainsText.trim().split("\n").filter(d => d.trim()); console.log(`Seeding ${domains.length} domains...`); Promise.all(domains.map(domain => pool.query("INSERT INTO domains (domain, source, status) VALUES ($1, $2, $3) ON CONFLICT (domain) DO NOTHING", [domain.trim(), "seed_script", "pending"]))).then(() => { console.log("Seeding complete!"); pool.end(); }).catch(err => { console.error("Error:", err); pool.end(); });
